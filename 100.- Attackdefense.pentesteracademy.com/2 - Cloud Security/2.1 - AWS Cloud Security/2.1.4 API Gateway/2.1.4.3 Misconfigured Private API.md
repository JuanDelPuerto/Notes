API Gateway supports private API which can only be accessed through VPC endpoints. While creating such APIs, special care should be taken while writing out the resource policy as one misconfiguration can allow anyone to interact with the API.

**Objective:** Interact with the private API and retrieve the flag.

===========================================================

Checking API Gateways. Inspect Resource Policy
![[Pasted image 20210906112114.png]]
Private API on "student" account is enabled if DNS is privated or through VPC endpoint
![[Pasted image 20210906112947.png]]
Locating API Gateway URL with an "attacker" account
![[Pasted image 20210906113100.png]]
Launching an ec2 instance on default vpc
![[Pasted image 20210906113231.png]]
![[Pasted image 20210906113312.png]]
Launching an service ec2 VPC
![[Pasted image 20210906113444.png]]
Create a new security group with inbound and outbound traffic rules allowed
![[Pasted image 20210906113620.png]]
Creating a new VPC endpoint with the "execute-api" service, all Availability Zones, with the new security gruop: all access
![[Pasted image 20210906113751.png]]
Locating API Gateway URL with an "attacker" account
![[Pasted image 20210906114138.png]]

