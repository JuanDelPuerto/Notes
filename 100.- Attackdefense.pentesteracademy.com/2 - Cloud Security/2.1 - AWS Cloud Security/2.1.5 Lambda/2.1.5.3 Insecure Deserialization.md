Deserializing untrusted input is a very dangerous operation as the untrusted data could be used to abuse application logic and execute arbitrary code.

In this lab, we will take a look at how to perform pickle deserialization RCE attack on a webÂ  application  

**Objective:** Perform pickle deserialization RCE attack on the web application and retrieve the Role's access key, secret and session token.

=========================================================================

Using python to unpickle the object
![[Pasted image 20210921093729.png]]
The web application might be vulnerable to Pickle Deserialization RCE

Creating Pickle Deserialization RCE payload
![[Pasted image 20210921094005.png]]
	Retrieving Environment variable using subprocess --> `return (subprocess.check_output, (['printenv'],))`
	Pickling and base64 encoding payload
	`pickledData=pickle.dumps(CMD())`
	`base64.b64encode(pickledData)`
	
Modifying cookie value
![[Pasted image 20210921094617.png]]
The Webpage threw an error. The environment variables were dumped
![[Pasted image 20210921094701.png]]
