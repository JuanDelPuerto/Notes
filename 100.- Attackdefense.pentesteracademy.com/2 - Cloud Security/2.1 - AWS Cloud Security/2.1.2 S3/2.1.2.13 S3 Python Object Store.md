A web application uses Amazon S3 bucket as an object-store. There is a misconfiguration in the bucket policy which allows an anonymous user to write an object on the bucket.  

**Objective:** Get a shell on the web application server and retrieve the flag!

==================================================================

Navigate to the URL 
![[Pasted image 20210827231021.png]]
Check all the objects in assets directory --> `aws --endpoint http://s3.pentesteracademylab.appspot.com --no-sign-request s3 ls s3://assets`
![[Pasted image 20210827231212.png]]
Check all the objects in sessions directory --> `aws --endpoint http://s3.pentesteracademylab.appspot.com --no-sign-request s3 ls s3://assets/sessions`
One object is present in sessions directory

Interact with the s3 buckets using boto3 library
![[Pasted image 20210827231501.png]]
Unpickle the session data
![[Pasted image 20210827231603.png]]

Create python script to generate pickle payload and overwrite the recently created object
![[Pasted image 20210827231734.png]]

The payload will send bash reverse shell
Listener to receive the reverse shell, running the script and reloading the website

Searching for root flag --> `find / -name *flag* 2>/dev/null`

