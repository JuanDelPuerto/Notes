Discovering SMB protocols
`nmap -p445 --script smb-protocols 10.5.2.103`
Get info about the SMB security level
`nmap -p445 --script smb-security-mode 10.5.2.103`
Enumerate the users logged into a system
`nmap -p445 --script smb-enum-sessions 10.5.2.103`
Enumerate users logged throug an SMB share using credentials
`nmap -p445 --script smb-enum-sessions --script-args smbusername=administrator,smbpassword=smbserver_771 10.5.2.103`
Enumerating all available shares
`nmap -p445 --script smb-enum-shares 10.5.2.103`
Enumerating all shares with valid credentials
`nmap -p445 --script smb-enum-shares --script-args smbusername=administrator,smbpassword=smbserver_771 10.5.2.103`
Enumerating users
`nmap -p445 --script smb-enum-users --script-args smbusername=administrator,smbpassword=smbserver_771 10.5.2.103`
Get info about server statistics
`nmap -p445 --script smb-server-stats 10.5.2.103`
Enumerating available domains
`nmap -p445 --script smb-enum-domains --script-args smbusername=administrator,smbpassword=smbserver_771 10.5.2.103`
Enumerating avalaible user groups
`nmap -p445 --script smb-enum-groups --script-args smbusername=administrator,smbpassword=smbserver_771 10.5.2.103`
Enumerating services
`nmap -p445 --script smb-enum-services --script-args smbusername=administrator,smbpassword=smbserver_771 10.5.2.103`
Enumerating shared folders and drives, and then listing them with ls command
`nmap -p445 --script smb-enum-shares,smb-ls --script-args smbusername=administrator,smbpassword=smbserver_771 10.5.2.103`