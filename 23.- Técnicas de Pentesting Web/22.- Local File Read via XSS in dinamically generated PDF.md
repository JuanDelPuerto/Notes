https://blog.noob.ninja/local-file-read-via-xss-in-dynamically-generated-pdf/

** Vector de ataque **
La vulnerabilidad está presente en la herramienta generadora del pdf, ya que esta vulnerabilidad se da en servicios donde la herramienta captura el input del usuario para introducirlo en un pdf.

Si en el input del usuario introducimos un payload javascript para que posteriormente la herramienta, basada en javascript, ejecute el payload y su respuesta lo guarde en el pdf. El siguiente punto deberá ser descargar ese pdf que se crea dinámicamente y la inyección XSS será visible en el documento.

** Ejemplo de ataque en máquina Book_HTB **
En esta máquina se da la oportunidad de que como usuario normal podemos crear colecciones. Y explotando una vulnerabilidad SQL truncation hemos modificado el password del usuario administrador, por lo tanto también tenemos uso de su panel de administración, desde el cual podemos descargar los pdf.

1. Panel de usuario normal, podemos crear colecciones.
2. Panel de administrador, podemos visualizar las colecciones en formato pdf.
3. En el pdf vemos introducido lo que hayamos escrito en la colleción creada por el usuario normal.
4. Payload que introducir en el input al crear la colección:
		--> `<script>x=new XMLHttpRequest;x.onload=function(){document.write(this.responseText)};x.open("GET","file:///etc/passwd");x.send();</script>`
5. Al introducir este payload en el pdf y visualizarlo desde el usuario administrador, veremos el contenido de /etc/passwd.
6. Algo más interesante sería extraer el fichero id_rsa del usuario que creemos que puede tener su clave privada como autorizada para poder conectarse sin proporcionar contraseña, adjuntando su clave privada.
		--> `<script>x=new XMLHttpRequest;x.onload=function(){document.write(this.responseText)};x.open("GET","file:///home/reader/.ssh/id_rsa");x.send();</script>`