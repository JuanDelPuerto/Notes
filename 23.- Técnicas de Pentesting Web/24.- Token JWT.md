** jwt.io herramienta online para crear tokens jwt **
https://jwt.io/

# Introducción a los tokens web JSON
## ¿Qué es JSON Web Token?

JSON Web Token (JWT) es un estándar abierto ( [RFC 7519](https://tools.ietf.org/html/rfc7519) ) que define una forma compacta y autónoma de transmitir información de forma segura entre las partes como un objeto JSON. Esta información puede ser verificada y confiable porque está firmada digitalmente. Los JWT se pueden firmar usando un secreto (con el algoritmo **HMAC** ) o un par de claves pública / privada usando **RSA** o **ECDSA** .

Aunque los JWT se pueden cifrar para proporcionar también secreto entre las partes, nos centraremos en los tokens _firmados_ . Los tokens firmados pueden verificar la _integridad_ de los reclamos contenidos en él, mientras que los tokens encriptados _ocultan_ esos reclamos a otras partes. Cuando los tokens se firman utilizando pares de claves públicas / privadas, la firma también certifica que solo la parte que posee la clave privada es la que la firmó.

## ¿Cuándo debería utilizar JSON Web Tokens?

A continuación, se muestran algunos escenarios en los que los tokens web JSON son útiles:

-   **Autorización** : este es el escenario más común para usar JWT. Una vez que el usuario haya iniciado sesión, cada solicitud posterior incluirá el JWT, lo que le permitirá acceder a rutas, servicios y recursos que están permitidos con ese token. El inicio de sesión único es una función que utiliza ampliamente JWT en la actualidad, debido a su pequeña sobrecarga y su capacidad para usarse fácilmente en diferentes dominios.
    
-   **Intercambio de información** : los tokens web JSON son una buena forma de transmitir información de forma segura entre las partes. Debido a que los JWT se pueden firmar, por ejemplo, utilizando pares de claves públicas / privadas, puede estar seguro de que los remitentes son quienes dicen ser. Además, como la firma se calcula utilizando el encabezado y la carga útil, también puede verificar que el contenido no haya sido manipulado.
    

## ¿Cuál es la estructura de JSON Web Token?

En su forma compacta, los tokens web JSON constan de tres partes separadas por puntos ( `.`), que son:

-   Encabezamiento
-   Carga útil
-   Firma

Por lo tanto, un JWT suele tener el siguiente aspecto.

`xxxxx.yyyyy.zzzzz`

Analicemos las diferentes partes.

### Encabezamiento

El encabezado _generalmente_ consta de dos partes: el tipo de token, que es JWT, y el algoritmo de firma que se utiliza, como HMAC SHA256 o RSA.

Por ejemplo:

```
{
  "alg": "HS256",
  "typ": "JWT"
}
```

Luego, este JSON está codificado en **Base64Url** para formar la primera parte del JWT.

### Carga útil

La segunda parte del token es la carga útil, que contiene las notificaciones. Las afirmaciones son declaraciones sobre una entidad (normalmente, el usuario) y datos adicionales. Hay tres tipos de reclamaciones: reclamaciones _registradas_ , _públicas_ y _privadas_ .

-   [**Reclamaciones registradas**](https://tools.ietf.org/html/rfc7519#section-4.1) : se trata de un conjunto de reclamaciones predefinidas que no son obligatorias, pero sí recomendadas, para proporcionar un conjunto de reclamaciones útiles e interoperables. Algunos de ellos son: **iss** (emisor), **exp** (tiempo de vencimiento), **sub** (asunto), **aud** (audiencia) y [otros](https://tools.ietf.org/html/rfc7519#section-4.1) .
    
    > Tenga en cuenta que los nombres de las notificaciones tienen solo tres caracteres, ya que JWT debe ser compacto.
    
-   [](https://tools.ietf.org/html/rfc7519#section-4.2)Reclamos [**públicos**](https://tools.ietf.org/html/rfc7519#section-4.2) : estos pueden ser definidos a voluntad por aquellos que usan JWT. Pero para evitar colisiones, deben definirse en el [Registro de tokens web JSON de IANA](https://www.iana.org/assignments/jwt/jwt.xhtml) o definirse como un URI que contiene un espacio de nombres resistente a colisiones.
    
-   [**Reclamos privados**](https://tools.ietf.org/html/rfc7519#section-4.3) : estos son reclamos personalizados creados para compartir información entre las partes que acuerdan usarlos y no sonreclamos _registrados_ ni _públicos_ .
    

Un ejemplo de carga útil podría ser:

```
{
  "sub": "1234567890",
  "name": "John Doe",
  "admin": true
}
```

Luego, la carga útil se codifica en **Base64Url** para formar la segunda parte del JSON Web Token.

> Tenga en cuenta que para los tokens firmados, esta información, aunque protegida contra alteraciones, es legible por cualquier persona. No coloque información secreta en la carga útil o en los elementos de encabezado de un JWT a menos que esté cifrada.

### Firma

Para crear la parte de la firma, debe tomar el encabezado codificado, la carga útil codificada, un secreto, el algoritmo especificado en el encabezado y firmarlo.

Por ejemplo, si desea utilizar el algoritmo HMAC SHA256, la firma se creará de la siguiente manera:

```
HMACSHA256(
  base64UrlEncode(header) + "." +
  base64UrlEncode(payload),
  secret)
```

La firma se usa para verificar que el mensaje no se haya modificado en el camino y, en el caso de los tokens firmados con una clave privada, también puede verificar que el remitente del JWT es quien dice ser.

### Poniendo todo junto

El resultado son tres cadenas de URL Base64 separadas por puntos que se pueden pasar fácilmente en entornos HTML y HTTP, mientras que son más compactas en comparación con estándares basados ​​en XML como SAML.

A continuación, se muestra un JWT que tiene codificados el encabezado y la carga útil anteriores, y está firmado con un secreto. ![JWT codificado](https://cdn.auth0.com/content/jwt/encoded-jwt3.png)

Si quieres jugar con JWT y poner estos conceptos en práctica, puedes usar [jwt.io Debugger](https://jwt.io/#debugger-io) para decodificar, verificar y generar JWT.

![Depurador de JWT.io](https://cdn.auth0.com/blog/legacy-app-auth/legacy-app-auth-5.png)

## ¿Cómo funcionan los tokens web JSON?

En la autenticación, cuando el usuario inicia sesión con éxito con sus credenciales, se devolverá un JSON Web Token. Dado que los tokens son credenciales, se debe tener mucho cuidado para evitar problemas de seguridad. En general, no debe conservar los tokens más de lo necesario.

Tampoco [debe almacenar datos confidenciales de la sesión en el almacenamiento del navegador debido a la falta de seguridad](https://cheatsheetseries.owasp.org/cheatsheets/HTML5_Security_Cheat_Sheet.html#local-storage) .

Siempre que el usuario desee acceder a una ruta o recurso protegido, el agente de usuario debe enviar el JWT, normalmente en el encabezado de **autorización** utilizando el esquema de **portador** . El contenido del encabezado debe tener el siguiente aspecto:

```
Authorization: Bearer <token>
```

Esto puede ser, en ciertos casos, un mecanismo de autorización de apátridas. Las rutas protegidas del servidor buscarán un JWT válido en el `Authorization`encabezado y, si está presente, el usuario podrá acceder a los recursos protegidos. Si el JWT contiene los datos necesarios, la necesidad de consultar la base de datos para determinadas operaciones puede reducirse, aunque no siempre es así.

Si el token se envía en el `Authorization`encabezado, el uso compartido de recursos de origen cruzado (CORS) no será un problema, ya que no utiliza cookies.

El siguiente diagrama muestra cómo se obtiene y se utiliza un JWT para acceder a API o recursos:

![¿Cómo funciona un JSON Web Token?](https://cdn2.auth0.com/docs/media/articles/api-auth/client-credentials-grant.png)

1.  La aplicación o el cliente solicita autorización al servidor de autorización. Esto se realiza a través de uno de los diferentes flujos de autorización. Por ejemplo, una aplicación web típica compatible con [OpenID Connect](http://openid.net/connect/) pasará por el `/oauth/authorize`punto final mediante el [flujo del código de autorización](http://openid.net/specs/openid-connect-core-1_0.html#CodeFlowAuth) .
2.  Cuando se otorga la autorización, el servidor de autorización devuelve un token de acceso a la aplicación.
3.  La aplicación usa el token de acceso para acceder a un recurso protegido (como una API).

Tenga en cuenta que con los tokens firmados, toda la información contenida en el token está expuesta a los usuarios u otras partes, aunque no puedan cambiarla. Esto significa que no debe poner información secreta dentro del token.

## ¿Por qué deberíamos usar JSON Web Tokens?

Hablemos de los beneficios de **JSON Web Tokens (JWT)** en comparación con **Simple Web Tokens (SWT)** y **Security Assertion Markup Language Tokens (SAML)** .

Como JSON es menos detallado que XML, cuando está codificado, su tamaño también es más pequeño, lo que hace que JWT sea más compacto que SAML. Esto hace que JWT sea una buena opción para pasar en entornos HTML y HTTP.

En cuanto a la seguridad, SWT solo se puede firmar simétricamente mediante un secreto compartido utilizando el algoritmo HMAC. Sin embargo, los tokens JWT y SAML pueden utilizar un par de claves pública / privada en forma de certificado X.509 para la firma. Firmar XML con XML Digital Signature sin introducir oscuros agujeros de seguridad es muy difícil en comparación con la simplicidad de firmar JSON.

Los analizadores JSON son comunes en la mayoría de los lenguajes de programación porque se asignan directamente a los objetos. Por el contrario, XML no tiene un mapeo natural de documento a objeto. Esto hace que sea más fácil trabajar con JWT que con aserciones SAML.

En cuanto al uso, JWT se utiliza a escala de Internet. Esto destaca la facilidad del procesamiento del lado del cliente del token web JSON en múltiples plataformas, especialmente en dispositivos móviles.

![Comparación de la longitud de un JWT codificado y un SAML codificado](https://cdn.auth0.com/content/jwt/comparing-jwt-vs-saml2.png) _Comparación de la longitud de un JWT codificado y un SAML codificado_